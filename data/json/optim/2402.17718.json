{
    "optim": " \nAvailable online at www.sciencedirect.com \nManufacturing Letters \nManufacturing Letters 00 (2023) 000â€“000 \n           \n \n      \n   \n \n2213-8463 Â© 2023 The Authors. Published by ELSEVIER Ltd. This is an open access article under the CC BY-NC-ND license \n(https://creativecommons.org/licenses/by-nc-nd/4.0) \nPeer-review under responsibility of the scientific committee of the NAMRI/SME. \n52nd SME North American Manufacturing Research Conference (NAMRC 52, 2024) \nTowards a Digital Twin Framework in Additive Manufacturing: Machine \nLearning and Bayesian Optimization for Time Series Process Optimization  \nVispi Karkariaa, Anthony Goecknera, Rujing Zhaa, Jie Chena, Jianjing Zhangb,  \nQi Zhua, Jian Caoa, Robert X. Gaob, Wei Chena \naNorthwestern University, Evanston, IL 60208, USA \nb Case Western Reserve University, Cleveland, OH 44106, USA \n \n* Corresponding author. Tel.: +1-224-766-1920;. E-mail address: weichen@northwestern.edu \nAbstract \nLaser directed-energy deposition (DED) offers notable advantages in additive manufacturing (AM) for producing intricate \ngeometries and facilitating material functional grading. However, inherent challenges such as material property inconsistencies \nand part variability persist, predominantly due to its layer-wise fabrication approach. Critical to these challenges is heat \naccumulation during DED, influencing the resultant material microstructure and properties. Although closed-loop control methods \nfor managing heat accumulation and temperature regulation are prevalent in DED literature, few approaches integrate real-time \nmonitoring, physics-based modeling, and control simultaneously in a cohesive framework. To address this, we present a digital \ntwin (DT) framework for real-time model predictive control of process parameters of the DED for achieving a specific process \ndesign objective. To enable its implementation, we detail the development of a surrogate model utilizing Long Short-Term Memory \n(LSTM)-based machine learning which uses Bayesian Inference to predict temperatures across various spatial locations of the \nDED-built part.  This model offers real-time predictions of future temperature states. In addition, we introduce a Bayesian \nOptimization (BO) method for Time Series Process Optimization (BOTSPO). Its foundational principles align with traditional BO, \nand its novelty lies in our unique time series process profile generator with a reduced dimensional representation. BOTSPO is used \nfor dynamic process optimization in which we deploy BOTSPO to determine the optimal laser power profile, aiming to achieve \ndesired mechanical properties in a DED build. The identified profile establishes a process trajectory that online process \noptimizations aim to match or exceed in performance. This paper elucidates components of the digital twin framework, advocating \nits prospective consolidation into a comprehensive digital twin system for AM. \n \nÂ© 2023â€‰The Authors. Published by ELSEVIER Ltd. This is an open access article under the CC BY-NC-ND license \n(https://creativecommons.org/licenses/by-nc-nd/4.0) \nPeer-review under responsibility of the scientific committee of the NAMRI/SME. \nKeywords:Directed Energy Deposition, Additive Manufacturing, Digital Twin, Process Optimization, Long-Short Term Memory, recurrent neural network, \nBayesian Optimization  \n \n1. Introduction \nLaser directed-energy deposition (DED) is an additive \nmanufacturing (AM) technique where powder or wire \nfeedstock is introduced into a laser-formed moving melt pool, \ncreating a deposition bead. Stacking these beads produces a \nthree-dimensional part. Laser DED allows for near-net shape \nfabrication of freeform geometries with internal features and \noffers material grading unattainable by conventional methods, \nfacilitating localized material optimization [1]. However, broad \napplication of DED is currently limited by heterogeneity and \nanisotropy in DED part mechanical properties, as well as part-\nto-part variation, due to the incremental nature of DED \nfabrication [2]. \nDED's layer-wise fabrication, paired with high melt \ntemperatures, induces cyclic thermal cycles, leading to unique \nmicrostructural textures  [3]. The cumulative heat and additive \nnature create uneven thermal histories. Although post-build \ntreatments can moderate this, some DED phenomena, like Î´-\nphase growth in Inconel 718, optimize subsequent treatments \n2 \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \n[4]. Thermal accumulation can result in chemical alterations \ndue to selective evaporation of elements, while heterogeneous \ncooling conditions can result in spatially variate mechanical \nproperties [5,6]. While hybrid additive manufacturing that \nintroduces secondary energy sources can adjust microstructure, \nthey increase costs and complexity [7]. Control of DED \nproperties via control of laser power therefore remains a \nworthwhile technique. Thermal objectives may be derived \nfrom experimentally observed insights, or solidification \nsimulations using phase-field, cellular automata, or kinetic \nMonte Carlo techniques [8]. \nSeveral works in DED sought to minimize part variations, \nusing direct melt pool temperature measurements as an input \nfor a PID controller. For instance, a rule-based controller was \nused to stabilize melt pool temperatures, reducing part-to-part \nporosity variation [9]. Such control schemes fail to take \nadvantage of disturbances known a priori, while feedforward \ncontrol can proactively anticipate and compensate for such \ndisturbances. For instance, Liao et al. employed a virtual PID \nin a heat transfer simulation to generate a feedforward control \ninput \n[10]. \nIntegrating \nthese \nwith \nfeedback \ncontrol \ncompensates for discrepancies in the model versus real-world \nconditions. A hybrid feedback-feedforward system, merging a \nheat transfer model with a PI controller, effectively maintained \nmelt pool temperatures by adjusting laser power [11]. \nHowever, such models may not intelligently track changes in \nsystem dynamics if such dynamics were not modelled \nexplicitly. Incorporating additional physics to these closed-\nloop controllers typically increases the cycle time, reducing \ncontroller performance. \nEvidently, there is need for a manufacturing system model \nfor DED that 1) models a target parameter, such as temperature \nor flaw concentration in the relevant regions that cannot be \ndirectly observed, 2) is updated during the online process to \naccount for differences between the physical system and the \nvirtual model, and 3) communicates changes in the system state \nto the real system, aiding control decisions based on these \nupdated conditions. Such a system is termed a digital twin (DT) \n[12,13]. Though many works have built so-called â€œdigital \ntwinsâ€ for DED that track model dynamics as a response to in-\nsitu measurement data, these predictions are often not suited for \nonline control due to the computational complexity and the lack \nof the characteristic bidirectional communication between the \ndigital and physical twins.  As a result, these are more suited to \nbe termed as â€œdigital shadowsâ€ only. \nTo build this digital twin for part temperature in DED, we \nmust first construct a fast surrogate model for online \nevaluation. Various methods have been used for rapid, reduced-\norder temperature models in AM. Physics-informed neural \nnetworks [14] were used to assess transient temperatures near \na DED-like heat source [15]. However, modifications in \nboundary conditions, such as geometry changes, require \nextremely expensive retraining. GRU neural networks [16] and \nlater, recurrent graph networks [17], were used for temperature \nprediction in DED parts. While they perform well for new \ngeometries and longer time steps, their effectiveness under \ndynamic laser power variation remains untested. The heat \nconduction graph network [18] accommodates variable laser \npower, but its predictions lack the uncertainty quantification \n(UQ) and real-time prediction which is vital for the digital twin \nframework. UQ offers insights into model accuracy, a required \nfeature for intelligent decision-making in the online system. \nMoving forward the offline trained surrogate model should \nbe employed for online predictive control. In most cases, online \npredictive models need a process trajectory, which is obtained \nby offline optimization. As accurate DED simulations can \ninvolve detailed physics, they are typically expensive to \nexecute. It is therefore beneficial to minimize the number of \niterations in the optimization process [19]. Attempts at finding \nan optimized laser power profile of DED have been made; \nhowever, many require a fully differentiable surrogate model \n[20]. Differentiable simulations make the derivatives of \nobjective functions with respect to process inputs directly \navailable; however, they have very high memory requirements, \nwhich limits their applicability to part scale builds.  \nRecognizing these challenges, the integration of digital twin \ntechnology within the laser DED process aligns with Industry \n4.0's drive towards intelligent manufacturing [21]. Digital \ntwins, key elements of Industry 4.0, facilitate a dynamic \nmanufacturing environment, enhancing real-time control and \npredictive accuracy through seamless integration of cyber-\nphysical systems [22]. This approach not only embodies the \nprinciples of Industry 4.0 but also marks a significant \nadvancement in adaptive, data-driven manufacturing process \ncontrol and optimization. \nIn this study, we present a digital twin architecture to control \nand optimize manufacturing processes, with the following \ncontributions: \n1. We propose a digital twin framework for the additive \nmanufacturing process that facilitates a bidirectional \ninformation exchange between virtual and physical systems \nwhere the framework incorporates online model predictive \ncontrol for real-time process adjustments and offline model \nupdates for enhanced prediction accuracy. Additionally, the \nframework mitigates sources of uncertainties including the \nâ€œunknown of unknownsâ€.  \n2. We develop a Bayesian LSTM architecture as a surrogate \nmodel which predicts the future temperature state by \nlooking at the past measurable temperature state, and other \ninput variables It handles the spatial-temporal dynamics of \nthe DED process and emphasizes significant past events \nwhile quantifying uncertaintyâ€”vital for informed decision-\nmaking within a digital twin framework. Different from \nconventional LSTMs, our model adopts Bayesian inference, \nutilizing Monte Carlo dropout methods to gauge predictive \nuncertainty by estimating Bayesian posterior distributions. \n3. We develop a low-dimensional representation for high \ndimensional time series of process inputs by decomposing \nhigh-dimensional laser profile time series into a set of low-\ndimensional parametric time series functions that capture \ndistinct laser profile characteristics. This enables the use of \nBO to find an optimal time series profile with adaptive \nsampling using fewer samples. We demonstrate the \ncapabilities of this method by optimizing a time series \nprofile of laser power with the objective of maximizing heat \ntreatment time throughout DED-built parts for better \nmaterial quality. \nThis paper is structured as follows: Section 2 delineates the \narchitecture of a digital twin framework applied to additive \nmanufacturing. Section 3 discusses the implementation and \nvalidation of a Bayesian LSTM designed to forecast \n \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \n 3 \ntemperatures during laser DED. Section 4 explicates the novel \nBayesian Optimization for Time Series Process Optimization \n(BOTSPO) method, which reduces the complexity of time-\nseries data for laser power inputs in DED processes and \nexamines its efficacy in deriving an optimal power profile. The \npaper concludes with a synopsis of its contributions and a \ndiscourse on prospective research directions. \n2. Digital Twin (DT) framework for the Additive \nManufacturing Process \nMany existing DTs only provide a â€œdigital shadowâ€ of the \nphysical system. In this work, a DT framework is proposed to \nintegrate physics-based models together with real-time data \ncollection (physics-based ML) for fast and accurate -property \nprediction and process optimization. Different from existing \nworks that use system performance as objective function in \noptimization or decision making, we introduce two-way \n(physical-to-virtual and virtual-to-physical) information-\ncentric value proposition.  Model Predictive Control (MPC) is \nincluded for anticipating and taking control actions based on \ncurrent and future events, which distinguish it from linearâ€“\nquadratic regulators and PID controllers. Unlike standard \npractices where model validation is a one-time, offline event, \nour DT leverages continuous online data to ensure the model \nremains accurate and reliable, effectively bridging the gap \nbetween the physical and digital realms. This method advances \nhow we implement model predictive control, offering a more \nadaptive and responsive system compared to conventional \ncontrol strategies. \nTo demonstrate the above-described DT framework, we \npresent a DT to support real-time DED manufacturing process \noptimization, which is shown in Fig. 1. The left block is the \nphysical system, and the right block is the digital system. The \ntwo blocks in between show the bidirectional interplay between \nthe physical system and the digital system. The physical system \nis the manufacturing process which is guided and programed \nby pre-process inputs and monitored by sensors. The process \nparameters are controlled, e.g., laser power. To achieve the \nobjective of temperature control, the digital system is created \nusing high fidelity finite element method (FEM) simulations \nwhich take geometric parameters, material parameters and \nprocess parameters as inputs, and predict temperature at each \nlocation of the built part. In this study, the process control \nparameters are the laser power at each step in time. To enable \nreal time analysis and decision making, a surrogate time series \nmodel is needed to replace the expensive FEM simulations.    \nUncertainties exist in the DT including aleatoric uncertainty \narising from inherent randomness and unavoidable variations \n(e.g., material and manufacturing variability, and sensor noise) \nand epistemic uncertainty arising from limited knowledge and \ndata (e.g., numerical uncertainty, and model uncertainty). To \naccount for both aleatoric and epistemic uncertainties, the \npredictive model is updated by combining data from both the \nphysical and the digital system. The offline updated surrogate \nmodel is then fed into an online MPC system. Different from \ntraditional feedback control techniques, MPC can better handle \nconstraints and nonlinearities associated with the object or \nsystem of interest and performs process optimization to identify \nthe best control action based on the current state of the system, \na predictive model, and a decision-making objective. MPC \noptimizes the current timeslot while considering future \ntimeslots through iterative optimization of a finite time-\nhorizon, implemented sequentially. With real-time sensing, the \ncapability of MPC allows the digital twin to make real-time \n(online) adjustments and optimizations in response to \nuncertainty and variations that cannot be predicted or mitigated \noffline, the so-called unknown of unknowns (i.e., unexpected \nor unforeseeable conditions). \nIn this work, we focus on the development of the surrogate \nmodel and offline process optimization in the digital system, \nwhich are described in the following sections. \n3. The Bayesian LSTM network as a surrogate model  \n3.1 Architecture of the Bayesian LSTM model \nTo be effective for real-time operation, and tightly coupled \noperation with a physical system that it mirrors, the digital twin \nmust be capable of rapid data processing and control [12]. As \nFig. 1. Schematic of our proposed Digital Twin Framework for DED Additive Manufacturing; In this paper we focus on the Bayesian LSTM, the Surrogate \nModel we selected, and the offline optimization, which aids the Model Predictive Control \nÂ¬\nÂ¬\nUpdate Surrogate\nModel Parameters\nPhysical System\nManufacturing\nProcess\nManufacturing Pre-\nProcesses\nLaser\nSensor\nCloud Data Storage\nDigital System\nHigh Fidelity Model\nMaterial\nParameter\n(ğœƒ)\nModel\nPredictive\nControl\nMeasured\nVariables\nPredicted\nVariables\nUpdated State ğœƒ\nPhysical\nDigital\n(Feedback)\nPhysical\nDigital\n(Update)\nFeedback ğ‘¥ğ‘˜\n-\n(From Domain)\nSurrogate Model\nğ‘¥ğ‘˜+1 = ğ‘“ ğ‘¥ğ‘˜, ğ‘¢ğ‘˜, ğœƒ, ğ‘”\n(Temperature of selected Node)\nGeometric\nParameter\n(g)\nProcess\nControl ğ‘¢ğ‘˜\nObjective Function, Constraints, and\nReference Trajectory\n(From Domain Knowledge)\nProcess\nControl\n(ğ‘¢ğ‘˜)\n4 \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \neven simplified pure physics models are much too slow to run \nin real time, we turn to a machine learning (ML) model to \nestimate the temperature throughout the part [23]. We achieve \nthis speedup using a recurrent neural network-based surrogate \nmodel, which also considers past events while making \npredictions. In this section, we describe the architecture of the \nmodel and the design decisions behind it. \nThe surrogate model as shown in Fig. 2 predicts the \ntemperature history at a particular point by taking the following \nfeatures, as illustrated by Fig. 4: the distance from the point to \nthe laser deposition point (ğ·ğ¿! ) and to the nearest surface \nboundary (ğ·ğ‘! ), the time at which the point is deposited \n(ğ‘‡\"#$!%), the laser power at the deposition time (ğ¿ğ‘ƒ\"#$!%), the \ncurrent laser power (ğ¿ğ‘ƒ!), and the measured temperature from \nthe previous time window (ğ‘‡!&':!&)). We identify these inputs \nfrom previous successful RNN-based modeling of the DED \nprocess [16], with the addition of the time and spatially variant \nlaser power features. The current temperature prediction at a \nlocation can be written as a function of Bayesian LSTM model \nas follows:  \n \nğ‘‡! = ğ‘“(ğ·ğ¿!, ğ·ğ‘!, ğ‘‡\"#$!%, ğ¿ğ‘ƒ\"#$!%, ğ¿ğ‘ƒ!, ğ‘‡!&) ) \n(1) \n \nThese input features are either time-variant or time-\ninvariant. We found through experimentation that the Bayesian \nLSTM performed poorly when provided with time-invariant \ndata as opposed to the time-variant data. This performance \ndegradation occurs even if only a portion of the input data is \ntime-invariant. Therefore, our surrogate model is composed of \ntwo primary data paths, one for time-variant data and the other \nfor time-invariant data, which are eventually concatenated. The \ntime-invariant data is fed to a forward layer with 100 nodes \nwhose output corresponds to spatial information, such as \nlocation. \nIn this model, we have two LSTM layers with 500 LSTM \nneuron units. This neuron count strikes a balance between \ncomputational efficiency and model complexity. LSTMs are \npreferred in our study for their architecture, which includes a \nmemory cell and three gates. This enables the model to \neffectively regulate the flow of information, remembering \nâ€¦\nâ€¦\nLSTM Layer 1\nLSTM Layer 2\n!\nMonte-Carlo \nDropout\nFinal Layer\nFeed Forward Layer\nTemporal \nInputt-6\nTemporal \nInputt-5\nTemporal \nInputt\nAttention Layer\nSpatial \nInputs\nFeed Forward Layer\nTemporal \nOutputt\nFig. 2. Architecture of the LSTM-based neural network to predict temperature at different spatial locations; time-invariant inputs include laser power at element \nbirth (ğ¿ğ‘ƒ!\"#$%), and Node deposition time (ğ‘‡!\"#$%), while time-varying inputs include distance from node to edge of built part (closest) (ğ·ğ‘$), distance from \nlaser deposition point to node (ğ·ğ¿$), laser power at current time (ğ¿ğ‘ƒ$), and temperature of previous time step at the same location (ğ‘‡$&'). The temporal output \nis the temperature of the current time step of the selected node. \nFig. 3. Flowchart demonstrating the data preparation, simulation, and training strategy steps of section 3.2 â€œBayesian LSTM model training strategyâ€ \nTime sequence via Monte \nCarlo Markov Chain (MCMC)\nLa8n Hypercube \nSampling (LHS)\nInput variable range\nLaser power \nproï¬le\ngenera.on\nGAMMA Simula8ons \nfor data genera8on\nSliding window \nfor training\nFeatures\nLSTM training\nTemperature \nPredic.on\nUncertainty\n \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \n 5 \npatterns over long sequences and discarding irrelevant data \n[24]. The selection of these hyperparameters followed a tuning \nprocess to ensure the model's performance is maximized for our \nspecific dataset and task requirements. Their ability to handle \ncomplex dependencies makes them similar to GRUs for \nmodeling the intricate thermal patterns in DED applications \n[25,26]. Their capability to utilize past data for future forecasts \naligns with our need to monitor the evolving state of the DED-\nbuilt part [27]. Our enhanced Bayesian LSTM model integrates \nan attention layer [28]. Specifically, the attention mechanism \nin our Bayesian LSTM model operates by assigning varying \nweights to different time steps in the temperature data \nsequence, thereby allowing the network to 'attend' more to \nmoments with significant thermal activity and less to others \n[29,30]. This facilitates the model's ability to dynamically \nemphasize temperature anomalies or shifts that could lead to \ndefects, enabling precise adjustments to process inputs.  \nTo enhance the model's accuracy in representing the spatial \nvariations in DED, we incorporated a feedforward layer with \n100 nodes [31].  This feedforward layer aggregates the features \nextracted by the LSTM layers, combining the sequential \ntemporal data processed by the LSTM with spatial correlations \n[29] Recognizing the importance of model robustness, we \nintroduced post-LSTM dropout layers. Dropout techniques \n[32], serve as effective regularization tools that prevent \noverfitting. Our model employs Monte Carlo dropout to \nquantify uncertainty alongside mitigating overfitting by \nsampling with random node exclusion. Specifically, Monte \nCarlo dropout is applied during both the training and prediction \nphases to all the layers of the neural network, repeatedly \n'turning off' a random subset of neurons in the network [33]. \nThis process creates multiple 'thinned' networks, each \ngenerating its own predictions [34]. The variance among these \nsamples indicates uncertainty. Through this architecture, our \nmodel can predict future temperature while simultaneously \nquantifying uncertainty. \n3.2 Bayesian LSTM model training strategy \nTo train our Bayesian LSTM machine learning model, we \nused FEM simulations to generate a bank of simulated full-field \ntemperature measurements for our test geometry. To that end, \nwe used a GPU-accelerated explicit heat transfer model  to \nsimulate our test geometryâ€™s temperature history across a range \nof deposition laser power profiles. Then, we sampled \ntemperature histories from individual locations across the \nbuild, and used the temperatures experienced by these \nindividual points to train the data-driven model. This approach \nis illustrated by Fig. 3. \nFig. 4. illustrates the test geometry used in this work, which \nconsists of a bidirectionally scanned thin wall constructed from \nInconel 718 built on a substrate of low-carbon 1018 steel. The \nscanning speed was set to 7 mm/s, and the 1/e2 beam diameter \nwas set to 2.24 mm. The build consists of 40 consecutive 0.75 \nmm tall layers. The simulation parameters are calibrated to an \nin-house laser-powder DED machine, the Additive Rapid \nPrototyping Instrument (ARPI). A detailed discussion of the \nformulation of the thermal model and comparison of full-field \ntemperature predictions with the physical DED system be \nfound in Liao et al. [10]. The model was also proven to offer \nsufficiently accurate melt pool temperature predictions for laser \npower optimization in [11]. \nA two-step method, combining Latin Hypercube sampling \n(LHS) and Markov-chain Monte Carlo (MCMC) was used to \ngenerate a representative library of laser power profiles; \nnamely, LHS is used to sample from a space of parameters that \ndescribe the laser history. LHS is used for its ability to \nefficiently sample from the entire high-dimensional space of \nexperimental parameters [35]. To accurately sample the space \nof possible laser profiles, the laser power profile was broken \ninto three fundamental properties: frequency, mean, and \nvariance. The frequency component captures how rapidly the \nlaser power is allowed to change from one time step to the next. \nHigh-frequency changes are reflective of events such as rapid \ndrops in laser power, as may be experienced in an optimized \ntrajectory near a turnaround point [11]. The mean component \nalters the average of the laser power in the trajectory. Finally, \nthe variance component gauges the extent of variability or \nfluctuation within the laser power trajectory. These three \nvariables provide a comprehensive coverage of the parameter \nspace [36]. \nUsing LHS, 50 parameter sets were generated within set \nbounds (Mean: 400-700 W, Variance: 50-300 W, Frequency: \n0-1 Hz) heuristically based on prior IN718 deposition \nFig. 5. Schematic of sliding window which is applied to feed data while \ntraining the Bayesian LSTM Model. The sliding window has a length of \n200-time steps, which is 2 seconds. The frequency is 50 Hz, and the sliding \nwindow slides for 100 time steps. \nFig. 4. Snapshot of FEA simulation, illustrating extracted features. The laser, \nindicated by ğ¿ğ‘ƒ$, travels in the direction of the red arrow. The point of interest \nis represented by the pink star, which is at a distance ğ·ğ‘$ from the closest free \nsurface and ğ·ğ¿$ from the laser. The laser power is recorded for the current \ntime, as well as the time at which the first element containing the node was \nactivated. When an element in the current layer is within the laser spot \nboundary, (A in the Fig.), it is activated. The final wall height is 30 mm. The \nlocation of the three nodes under consideration are included. \n6 \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \nexperience. The profiles were then generated via MCMC in \narbitrary unit space and scaled and shifted to the requested \nmean and variance. The signals were then filtered to the \nrequired temporal frequency with a 2nd-order low-pass \nButterworth filter. The Butterworth filter is a general-use filter \nin signal processing with a flat frequency response in the \npassband [37]. \nFrom each run of the FEM simulation, we collect various \ndata which will form the input features to our surrogate model. \nThroughout the paper, we refer to â€œlocationsâ€ of importance in \nthe DED-built part; these locations are one-to-one mappings \nwith nodes in the finite element model. At each time step, we \nrecord the input and output data required to train our machine \nlearning model. The finite element simulation runs at an \nexplicit time step of 0.002 seconds. The full-field temperature \nfield and training parameters are continuously gathered every \n10 simulation steps, or every 0.02 seconds. We then repeat the \nsimulation using different laser profiles, resulting in training \ndatasets for each laser profile. \nTo achieve location-agnosticism of the surrogate model, we \nmust sample from datasets of multiple laser profiles from all \nthe available 96000 nodes during training. For this purpose, we \nhave developed a data management pipeline. Each sample used \nfor training is a sliding window of time-series data [38] as \nshown in Fig. 5. During sampling, time windows are \noverlapped such that the latter half of data points in one \nwindow are also included as the former half of data points in \nthe next window [39]. During training, individual time \nwindows are sampled randomly from datasets of 80 laser power \nprofiles of 280 seconds to create mini batches of samples. \nUsing these mini-batches, training of the model proceeds \nusing the gradient descent method. Loss is calculated using the \nevidence lower bound (ELBO) [40] method and is defined as \nfollows: \n \nğ¿(ğœ™, ğœƒ, ğ‘¥) â‰” ğ”¼*~,!(â‹…|ğ‘¥)[ln ğ‘0(ğ‘¥|ğ‘§)] âˆ’ ğ·12;ğ‘3(â‹… |ğ‘¥) âˆ¥ ğ‘> (2) \n \nwhere ğ‘¥  is the observed data points, ğœ™  are the parameters \ndefining the approximate posterior distribution, ğœƒ  is the \nParameters of the true intractable distribution,  ğ‘§ is a latent \n(unknown) continuous random variable, ğ‘0 (ğ‘¥|ğ‘§)is the true, \nintractable distribution of ğ‘¥, ğ‘3 (â‹… |ğ‘¥)  is the approximate \nposterior, and ğ·12  is the Kullbach-Leibler (KL) divergence \nfrom distribution ğ‘0 (â‹… |ğ‘¥) to distribution ğ‘3 (â‹… |ğ‘¥). The ELBO \nloss function is originally described in Auto-Encoding \nVariational Bayes [40], and we found via experimentation that \nit is highly effective when used for training our surrogate \nmodel. The ELBO method stands out for uncertainty \nquantification due to its decomposition of the marginal \nlikelihood into two interpretable components: the expected log-\nlikelihood and the KL divergence. The first term, expected log-\nlikelihood, quantifies how well the model explains the \nobserved data, whereas the KL divergence penalizes deviations \nfrom the prior and acts as a regularize, preventing overfitting. \nThis decomposition provides a robust balance between data \nfidelity and model complexity, ensuring a principled \nquantification of uncertainties. In the next section, we will look \nat the prediction capability of the Bayesian LSTM model.  \n3.3 Evaluation of the LSTM Model \nIn evaluating the performance of our Bayesian LSTM \nmodel, we compare the resulting outputs against simulated \nmeasurements. In our first evaluation we input the past \nmeasurable temperature or the actual temperature as an input. \nThe LSTM model's performance assessment is carried out \nusing a set of 20 distinct laser power profiles, each with a \nduration of 280 seconds, specifically reserved for validation \npurposes. \nIn this case the models achieved an ğ‘…4 score of 0.75, \nindicative of a good degree of accuracy and alignment with the \nexpected outcomes. The ğ‘…4 score, commonly referred to as the \ncoefficient of determination, quantitatively measures the \nproportion of the variance in the dependent variable that is \npredictably explained by the independent variables in a \nregression model. This result was validated through k-fold \ncross-validation and independent set evaluation to ensure \nmodel robustness against overfitting. \nThe temperature profiles for nodes 27550, 37550, and 32550 \nare shown over an extended period for a representative laser \npower profile in Fig. 6. These points were chosen to illustrate \nthe thermal history at a variety of distances from the turnaround \nregions and part surface. Fig. 6. shows that the ground truth \ntemperature (represented in orange) aligns closely with the \nLSTM predictions (shown in blue). The accompanying shaded \nregion illustrates the uncertainty bounds, which are derived \nusing a 95% confidence interval. By examining these diagrams, \nit is evident that while the model offers a reasonable \napproximation of the actual temperature profiles, the prediction \nquality is poorer when the laser is further from the node under \ninvestigation, with predictions tending to be higher than the \nground truth simulation. \nFor effective prediction of the internal temperatures of the \nfabricated \npartâ€”temperatures \nwhich \nare \ninherently \nunobservableâ€”the model can leverage prior temperature \nestimations from the Bayesian LSTM to subsequently predict \nFig. 6. Evaluation of the Bayesian LSTM model on test dataset for three locations in the thin wall with a sliding window prediction length of 2 seconds in future \nover a total duration of 280 seconds; Comparison of model prediction (blue line) and the actual value (orange line) with 95% uncertainty band (grey shaded area). \nTemperature (K)\nTemperature (K)\nTemperature (K)\n \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \n 7 \nupcoming temperatures. This sequential prediction will be \nimportant when interfaced with the physical plant. While the \nmain emphasis of this study revolves around surface \ntemperatures, where prior temperatures are assumed to be \nknown, the LSTM may also be run using the temperature \npredictions at previous time steps as input. As shown in Fig. 7, \nthe model reliably predicts internal temperatures with a \nconfidence level of ninety-five percent for six seconds. \nAlthough the model demonstrates high predictive accuracy \noverall, the model's reliance on its own outputs results in \nsubstantial error accumulation past the first temperature peak. \nIn the digital twin context, the Bayesian LSTM model serves \nas a critical predictive tool for advanced manufacturing. By \nincorporating the Bayesian LSTM into the digital twin \nframework, the system can proactively monitor thermal \nbehavior in real-time during DED processes and update its \nunderstanding of system dynamics. This integration is vital for \nprecision in complex structures, where slight changes in \ndeposition conditions can greatly affect the properties of built \nparts. \n4. Bayesian Optimization for Time Series Process \nOptimization (BOTSPO) \n4.1 Description of the BOTSPO method:  \nDigital twin technology underlines the essential link \nbetween offline analyses and online implementations. Offline \noptimization fine-tunes parameters using historical data to \nenhance online predictive control effectiveness [41,42]. \nFundamentally, \noffline \noptimization \ntranscends \nmere \npreparatory operations, laying the foundation for the \nperformance of online optimization [43]. \nIn this section, we develop a methodology to efficiently \nrepresent the laser power profile utilizing a minimal set of \nparameters as shown in Fig. 8. Within the BO framework, we \nemploy a Gaussian process (GP) model to capture the nonlinear \nrelationships between laser profile parameters and the desired \ncharacteristics of laser profile along with their uncertainties, \nthereby enabling robust and efficient exploration and \nexploitation of the process design domain. In BO, as the \ndimensionality of the parameter space increases, the \ncomputational complexity of the GP inference grows \nexponentially, leading to prohibitive computational overheads \n[44]. This phenomenon, often referred to as the \"curse of \ndimensionality,\" necessitates judicious selection of parameters \nto ensure the optimization remains tractable and efficient. We \ndeveloped a Fourier series-based time series profile generator \nfor laser power, leveraging its ability to dissect signals into \nsinusoids \nfor \nclear \nfrequency \ndomain \nanalysis \nand \nreconstruction of complex laser behaviors. \nTo derive our time series generator, we start with a simple \nFourier series profile [45]. Fourier series offer immense \nflexibility because they can approximate any periodic function \nwith a weighted sum of sines. \n \nğ‘¦(ğ‘¡) = ğ´ D2\nğœ‹\nF\n1\nğ‘– sin;2ğœ‹ â‹… ğ‘“ â‹… ğ‘– â‹… ğ‘¡ + (ğœ™)>\n)\n#5',# 89: 45'\nK \n(3) \n \nIn the above Fourier series formula, the parameters A, n, f, \nand Ï• represent the amplitude, number of terms, frequency, and \nphase of the Fourier series respectively. To keep the number of \nparameters low, and to increase the flexibility of the time series \nprofile generator we introduce ğ›¥ğ´, ğ›¥ğ‘“  and ğ›¥ğœ™ . \n \nğ‘¦(ğ‘¡) = (ğ´ + ğ‘›Î”ğ´) 02\nğœ‹\n3\n1\nğ‘– sin92ğœ‹(ğ‘“ + ğ‘–ğ›¥ğ‘“)ğ‘–ğ‘¡ + (ğœ™ + ğ‘–ğ›¥ğœ™)=\n'\n\"(),\" ,-. /()\n>  (4)  \n \nIn the above time series generator, we employ a modified \nFourier \nseries \ncharacterized \nby \nthree \nparameters: ğ›¥ğ´, ğ›¥ğ‘“, ğ‘ğ‘›ğ‘‘ ğ›¥ğœ™. The ğ›¥ğ´ parameter represents the \nrate of change of amplitude, adding adaptability to the model \nby allowing the amplitude to evolve over time. Concurrently, \nğ›¥ğ‘“  signifies the rate of change of frequency, enabling the \nmodel to responsively adjust the oscillation frequency of the \nlaser power. Lastly, ğ›¥ğœ™ describes the rate of change of the \nwave's phase, ensuring the model can compensate for temporal \nshifts in the laser power profile for alignment with real-world \nobservations. The introduction of these rates of change \n(Î”parameters) provides the representation with the flexibility \nto change its morphology gradually during the build while only \nintroducing a three new terms. \nTemporal trends and seasonality are essential components \nwhen modeling time series data, which comprises data points \nlisted at successive time intervals. A temporal trend, signified \nby the term ğ‘¡ in the equation ğ‘¦;(ğ‘¡) = ğ‘¦(ğ‘¡) + ğ‘‡ â‹… ğ‘¡, denotes a \nconsistent trajectory the data adheres to over time. The \ncoefficient ğ‘‡ represents the slope, capturing whether the laser \npower profile gradually increases, decreases, or remains stable \nover time. While the Fourier terms could theoretically capture \nsuch a trend, explicitly implementing a linear trend reduces the \nburden on the sinusoidal terms to represent noncyclic behavior. \nOn the other hand, seasonality captures recurring local \nbehavior in a time profile. This cyclic behavior is embodied in \nthe term ğ‘†ğ‘ ğ‘–ğ‘›(2ğœ‹ â‹… ğ‘¡ â‹… ğ‘†ğ¹) in the equation. Here, ğ‘† adjusts the \namplitude of the seasonal fluctuation, SF represent the \nfrequency in which this cyclicity is captured, and the sine \nfunction represents the cyclical pattern. Seasonality can also be \ncaptured by a custom function if the underlying cyclic behavior \nis known. By integrating both the temporal trend and \nseasonality, the equation ğ‘¦;(ğ‘¡)  provides a comprehensive \nFig. 7. Evaluation of Bayesian LSTM with its own temperature prediction as \nan input to the LSTM \n8 \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \nportrayal of the laser power profile over time, ensuring the \ndigital twin closely mirrors real-world dynamics. \n \nğ‘¦;(ğ‘¡) = ğ‘¦(ğ‘¡) + ğ‘‡ğ‘¡ + ğ‘† sin(2ğœ‹ğ‘¡ â‹… ğ‘†ğ¹)\n(5) \n \nIn total, the system utilizes ten tunable parameters, \nencompassing amplitude, frequency, phase, their rates of \nchange, and temporal dynamics to accurately capture and \nrepresent the laser power profile over time, yielding a robust \nand adaptive model for real-world applications.  \nThe selection of ten parameters for the time series generator \nwas empirically determined to strike a balance between model \ncomplexity and computational efficiency. These terms allow \nfor a sufficiently detailed representation of the laser power \nprofile (time series profile), capturing the essential dynamics \nwithout overfitting, which is a common concern with more \nparameters [46].  \nTo optimize the time series laser power profile, we \nemployed BO, a model-based optimization approach for \nmaximizing GP Models. The GP Model function links the ten \nadjustable parameters of our time series to the target objective. \nDenoting the ten parameters as ğ‘ where ğ‘ = [ğ‘', ğ‘4, â€¦ , ğ‘'<] \nand the heat treatment time as ğ‘“(ğ‘), the GP Model will be, \n \nğ‘“(ğ‘)~ğºğ‘ƒ;ğ‘š(ğ‘), ğ‘˜(ğ‘, ğ‘;)>\n(6) \n \nwhere ğ‘š(ğ‘)  is the mean function and ğ‘˜(ğ‘, ğ‘;)  is the \ncovariance function or kernel. In our study, we employed the \nradial basis function (RBF) [47]. The Radial Basis Function \n(RBF) kernel is a covariance function used in Gaussian \nprocesses that measures similarity based on the Euclidean \ndistance between points in the input space, with points closer \nto each other having higher covariance. It is recommended to \nset an upper limit, and lower limit of the ten parameters of the \ntime-series profile generator while linking the time-series \nprofile generator to the BOTSPO. The time-series profile \ngenerator can generate a wide range of time series profiles \nwhich might not be required for all the applications, and this \nlimit on the parameters should be made according to domain \nknowledge. \nOur optimization sequence, as outlined in Fig. 8, initiates \nwith Latin hypercube sampling to establish an initial Gaussian \nProcess (GP) model, setting the stage for capturing the \nunderlying function dynamics of the DED. Under this setup, \nthe Latin hypercube sampling method is employed to \nefficiently cover the 10 dimensional parameter space. This \ninitial GP model then serves as a probabilistic surrogate for the \nobjective function, facilitating the estimation of both the \nfunction's value and uncertainty across the parameter space. \nThen, BO focuses on the objective function and leverages the \nten parameters to generate a respective time series laser profile. \nFollowing the initialization phase, the BO process exploits the \nGP posterior to identify regions in the parameter space that \nlikely contain optimal solutions. To make this selection, we \nemploy the Upper Confidence Bound (UCB) as our acquisition \nfunction, formulated as: \n \nğ‘ˆğ¶ğµ(ğ‘¥) = ğœ‡(ğ‘¥) + ğœ…ğœ(ğ‘¥)\n(7) \n \nwhere ğœ‡(ğ‘¥)  is the GP posterior mean, ğœ(ğ‘¥)  represents the \nstandard deviation, and ğœ…  is an exploration-exploitation \nparameter that dictates the trade-off between exploring \nuncertain regions and exploiting known optima. By adjusting \nğœ… , we can finetune the balance between exploration and \nexploitation in our optimization routine. As iterations progress, \nthe GP model is updated with the newly observed data, refining \nthe predictive landscape. The BO iteratively utilizes the UCB \nacquisition function to select new samples, specifically \ntargeting regions that promise the most significant potential \nimprovement. It guides the search towards an optimal laser \npower profile by aiming to maximize the UCB with respect to \nthe objective function as shown in equation (10) that is \ncharacterized by the ten parameters. \nFig. 8. Framework illustrating the data flow in Bayesian Optimization for Time Series Process optimization (BOTSPO). This application of BOTSPO is \nspecifically illustrated for finding the optimal laser power for DED. \nInitialize\nGP Model\n!(#, #â€²)\nGenerate Time \nSeries based \nLaser Power \nProfile with 10 \nParameters\nLatin Hyper Cube \nSampling\n# ~ )(*, +)\nUpdate\nGP Model\n,, -!\nObjective \nFunction\n.(#\"#$)\nSetup  and Run \nSimulator\n(GAMMA)\nS(t)\nCalculate Average\nHeat Treatment \nTime along all \nSpatial Locations\nOptimize \nAcquisition \nFunction UCB \n#\"#$\n= arg max (5 # )\n10 89:; <;=9;> \n?;@;=*AB= C*=*:;A;=>\nNext candidate points\nHeat Treatment Time\nLaser Power (W)         \n \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \n 9 \nTo dynamically strike an optimal balance between \nexploration and exploitation in our BO process, we \nimplemented an adaptive approach for the parameter ğœ… , \nleveraging recent uncertainties in the GP model predictions. \nSpecifically, we designed an adaptive ğœ…, defined by: \n \nğœ…=:>?@!A:(ğ‘–) = ğ›½\"=@A(ğ‘–) â‹… (1 + ğ›¼ â‹… ğœŒ)\n(8) \nğ›½\"=@A(ğ‘–) = ğ›½< â‹… ğ›¾# \n(9) \n                                                               \nHere, ğ‘– denotes the iteration count, ğ›½< is a base value, ğ›¾ is \nthe decay factor fixed at 0.90, and ğœŒ calculates the standard \ndeviation, which quantifies the mean uncertainty over the \nprevious five BOTSPO iterations. The uncertainty adjustment \nfactor ğ›¼ is set to 0.1. By scaling ğœ… with a base value ğ›½< and an \ndecay factor ğ›¾#, we ensure that exploration is more aggressive \nin early iterations to discover the potential regions of interest \nand gradually becomes more refined. The inclusion of a \nresponsiveness factor ğ›¼  multiplied by the recent prediction \nuncertainty ğœŒ  allows ğœ…  to adjust dynamically, promoting a \nbalance between exploration and exploitation based on the \nevolving confidence in the model's predictions [44]. By \nincorporating this adaptive approach, our optimization process \ncan respond flexibly to the changing dynamics and \nuncertainties inherent in modeling of the DED process, \nproviding a more responsive and efficient search for optimal \nlaser profiles.  \nStriking an equilibrium between the exploration of \nparameter domains and the exploitation of regions of high \nperformance is pivotal. BOTSPO's algorithmic architecture, \ncharacterized by its adaptive mechanism, inherent noise \nrobustness, and sampling efficiency [41], is important for \nmanufacturing process optimization when the cost of collecting \ndata is high. This is particularly crucial for manufacturing \nprocess optimization, where the cost of data collection is high. \nThe use of Bayesian methods allows BOTSPO to make \ninformed decisions about which points in the parameter space \nto sample next, leveraging prior knowledge to improve both \nexploration and exploitation strategies. In the next section, we \nwill look at the results achieved by the BOTSPO method in the \ncontext of DED. \n4.2 Results from the BOTSPO method \nFor our objective function, we aimed to maximize the heat \ntreatment time of the material used in the simulation, which is \ndefined as follows, \n \nğ‘‡k = 1\nğ‘ F ğ‘Ÿ m\nmaxqğ‘—sğ‘‡8#) â‰¤ ğ‘‘ğ‘“#> â‰¤ ğ‘‡8=Bu\nâˆ’ minqğ‘—sğ‘‡8#) â‰¤ ğ‘‘ğ‘“#> â‰¤ ğ‘‡8=Buv\n \nC\n#5'\n \n(10) \n \nWhere  ğ‘‡k is the heat treatment time, ğ‘ is the total number of \nnodes, ğ‘Ÿ  is the data collection rate, ğ‘‡8#) and ğ‘‡8=B are the \nminimum and maximum temperatures of the desired range, \nğ‘‘ğ‘“#> is the temperature at the ğ‘— âˆ’ ğ‘¡â„ index for the ğ‘– âˆ’ ğ‘¡â„ node, \nmin{ğ‘—|ğ‘‡8#) â‰¤ ğ‘‘ğ‘“#\" â‰¤ ğ‘‡8=B})  is the first index where the \ntemperature is within the desired range of the ğ‘– âˆ’ ğ‘¡â„ node, and \nmax{ğ‘—|ğ‘‡8#) â‰¤ ğ‘‘ğ‘“#\" â‰¤ ğ‘‡8=B})  is the last index where the \ntemperature is within the desired range of the ğ‘– âˆ’ ğ‘¡â„ node.  \n In DED of IN718, multiple precipitates drive improved \nstrength in IN718, including the body centered tetragonal \nNi3Nb ğ›¾â€²â€² phase, which directly improves material strength \n[48], and the orthorhombic Ni3Nb ğ›¿ phase, whose plate-like \nmorphology has been demonstrated to cut up brittle Nb-rich \nLaves phases, thus improving the effectiveness of post-build \nheat treatments [4]. Xie et al. [49], identified using data-driven \ntechniques that the local strength of IN718 parts made using \nlaser-powder DED was related to the time spent between 654Â°C \nand 857 Â°C. As typical aging times for IN718 are in the range \nof hours at the effective soak temperatures [50] the objective \nwas set to strictly maximize the in-situ age time.  \nIn Fig. 10, we present the BO progression, illustrating the \nadvancement of the laser power profiles from the preliminary \nfirst iteration to the concluding 50th iteration. Initially, the GP \nmodel is trained utilizing a dataset of 50 laser power profile \nsamples prior to its integration into the BOTSPO algorithm. \nThis pre-training of the GP Model is imperative as it establishes \na foundational understanding of the underlying parameter \nspace, facilitating more informed and efficient exploratory \ndecisions in subsequent optimization stages.  \nIn Fig. 10, the BO function call history is delineated. In the \npreliminary iterations, there is a predominant focus on \nexploration to determine the optimal power profile to maximize \nthe heat treatment time. Later stages exhibit plateaus, indicating \na stable state and exploitation. A notable strength of BO, and \nsubsequently BOTSPO, lies in its sample efficiency: it requires \nfewer data points relative to traditional techniques, thus \nachieving optimal parameter discernment at a reduced \ncomputational expense. \nThe parameters outlined in Table 1 control the build quality \nby influencing the laser power profile in the DED process. The \n\"Amplitude of Fourier (A)\" sets the base intensity of the laser; \na higher amplitude translates to more energy input, essential for \ninitial layers. The \"Frequency of Fourier (f)\" controls the \nFig. 9. Laser Power Profiles at different BOTSPO iterations whose aim is to maximize heat treatment time; First figure is the laser power profile at iteration 1, \nsecond figure is the laser power profile at iteration 25, and the third figure is the laser power profile at iteration 50. \nHeat Treatment Time = 30.32 seconds\nHeat Treatment Time = 37.01 seconds\nHeat Treatment Time = 38.19 seconds\nLaser Power (W)         \nLaser Power (W)         \nLaser Power (W)         \n10 \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \noscillation frequency of laser intensity, affecting energy \ndistribution over time. \"Rate of Change in Amplitude (Î”A)\" \nand \"Rate of Change for Phase Shift (Î”Ï•)\" adjust the laser's \nresponse to thermal dynamics during printing. \"Linear Trend \nCoefficient (T)\" indicates a general trend in laser power \nrequirement as the build progresses. \"Seasonality Amplitude \n(S)\"  and â€œFrequency of Seasonality (SF)â€accounts for periodic \nvariations in laser energy needs due to changes in the build \ngeometry or material state. The \"Rates of Change for \nFrequency (Î”f)\" adapts the laser's temporal response to the \nevolving thermal profile. \nIn the optimum power sequence (Fig. 9, right), the laser \npower is initially high. This is likely due to the longer heat \ntreatment times at the beginning of the thin-wall build, as \nobserved in previous works [20]. The optimizer thus sought to \nmaximize this effect by driving up the early laser power. As the \nthin wall build progressed, the radiative and convective heat \ntransfer increased; like a fin, the build became more efficient in \nrejecting heat and the amount of time in the heat treatment \nrange decreased for the higher locations. The optimizer thus did \nnot seek to increase the laser power in later parts of the build, \nas even laser powers at the top of the specified range did not \nsubstantially improve the total heat treatment duration. \nThis result, while increasing the average heat treatment \nduration in the part, does not achieve material homogeneity. \nFuture work on the BOTSPO will implement multi-objective \noptimization that can balance joint objectives of maximizing \nheat treatment duration and homogeneity, thus preventing the \nfront-biased result in this work. \nUtilizing the proposed methodology allows us to determine \nan offline laser power profile, serving as a foundational process \ntrajectory for online predictive control during the laser-based \nadditive manufacturing process. This process trajectory can \nstreamline real-time adjustments, enhancing consistent \ndeposition quality and decreasing potential discrepancies \narising from fluctuating process dynamics in laser-based \nadditive manufacturing. \n4. Conclusion \n     In this paper, we proposed a digital twin framework for \nDED process control and optimization, an autonomous and \nsystematic approach that enables repeatable fabrication of \ncomplex parts. This paper contributes two major components \nof implementing the overall digital twin framework: a data-\ndriven, surrogate model that enables dynamic prediction of \ntemperatures with uncertainty quantification throughout the \npart in real-time, and a Bayesian Optimization Method for \nTime Series Process Optimization (BOTSPO) that determines \nappropriate laser power profiles for maximizing the partâ€™s \nprecipitation hardening time. \n First, we developed a Bayesian LSTM based surrogate \nmodel which is capable of temperature prediction for selected \nareas of the built part in real-time. The Bayesian LSTM model \nis laser profile-agnostic and is capable of accurate location-\nbased temperature prediction for simple geometries like thin \nwalls. We demonstrated the capability by training and \nanalyzing the predictive capabilities of the Bayesian LSTM \nmodel on a thin wall geometry with an ğ‘…4  score of 0.75. This \nsurrogate modelling capability will enable real-time MPC in \nthe online digital system when online monitoring information \nbecomes available. The distinctiveness of our Bayesian LSTM \nlies in its architecture that not only retrospectively considers \nmeasurable states and input variables but also adeptly \nunderstands the spatial-temporal dynamics inherent to the DED \nprocess. It has been designed to provide emphasis on \nsignificant historical events, while also quantifying the inherent \nmodel uncertaintyâ€”a critical feature for making informed \ndecisions in a digital twin environment. Unlike traditional \nLSTMs, our model incorporates Bayesian inference principles \nthrough the implementation of Monte Carlo dropout \ntechniques. This allows for an approximation of Bayesian \nposterior distributions, thereby furnishing a quantifiable \nmeasure of uncertainty in its predictions, which is important for \noptimizing the manufacturing process. \nSecondly, we introduced BOTSPO, which efficiently \nidentifies optimized laser power profiles to enhance heat \ntreatment and precipitation hardening. Given the computational \ndemands of high-fidelity FEM models, BOTSPO is engineered \nto ascertain optimal profiles with minimal function evaluations. \nAddressing the potentially infinite dimensionality of time \nseries profiles, we employ a dimension reduction strategy by \ndevising a time series profile generator that leverages a set of \n10 parameters, facilitating a comprehensive exploration of the \ntime series space without incurring prohibitive computational \ncosts. This approach is crucial as BO's efficiency inversely \ncorrelates with the number of parameters to optimize. We \ntested this approach with the objective of maximizing the heat \ntreatment time for the thin-wall IN718 build and found that the \nTable 1. Parameter Values of the Obtained Optimal Laser Power Profile at \niteration 50 of BOTSPO \nParameter Name \nValue \nAmplitude of Fourier (A) \n6.89 \nFrequency of Fourier (f) \n1.60 \nNumber of Terms of Fourier (n) \n1.00 \nPhase Shift of Fourier (Ï•) \n0.71 \nLinear Trend Coefficient (T) \n-90.0 \nSeasonality Amplitude (S) \n45.0 \nRates of Change for Frequency (Î”f) \n-0.27 \nRates of Change for Amplitude (Î”A) \n0.57 \nRates of Change for Phase Shift (Î”Ï•) \n-0.85 \nFrequency of Seasonality (SF) \n0.94 \nFig. 10. BOTSPO function calls. The function call depicts the \noptimization history used to find the optimal laser power in this paper.  \n \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \n 11 \nheat treatment time was maximized to 38.19 seconds. The off-\nline process optimization result will serve as the reference \nprocess trajectory in online model predictive control. \nFuture work will focus on the integration of the methods \npresented in this paper with a physical DED system. For \nphysical realization of a DED-DT systems, there are additional \ntasks to be considered, including online optimization of the \nlaser power profile, continuous model update using both online \nand off-line data, and drift correction of the surrogate model via \nmodel update from a more accurate sub-real-time model. \nAcknowledgements \nThe authors would like to acknowledge support from \nthe NSF Engineering Research Center for Hybrid \nAutonomous Manufacturing Moving from Evolution to \nRevolution (ERCâ€HAMMER) under Award Number \nEEC-2133630; \nthe \nNational \nScience \nFoundation \nGraduate Research Fellowship under Grant No. DGE-\n2234667; and fellowship support from The Graduate \nSchool at Northwestern University for the Predictive \nScience & Engineering Design (PS&ED) Cluster project. \nReferences \n [1] Li, Y., Feng, Z., Hao, L., Huang, L., Xin, C., Wang, Y., \nBilotti, E., Essa, K., Zhang, H., Li, Z., Yan, F., and Peijs, \nT., 2020, â€œA Review on Functionally Graded Materials \nand Structures via Additive Manufacturing: From Multi-\nScale Design to Versatile Functional Properties,â€ Adv. \nMater. Technol., 5(6), p. 1900981. \n[2] Dass, A., and Moridi, A., 2019, â€œState of the Art in \nDirected \nEnergy \nDeposition: \nFrom \nAdditive \nManufacturing to Materials Design,â€ Coatings, 9(7), p. \n418. \n[3] DebRoy, T., Wei, H. L., Zuback, J. S., Mukherjee, T., \nElmer, J. W., Milewski, J. O., Beese, A. M., Wilson-\nHeid, A., De, A., and Zhang, W., 2018, â€œAdditive \nManufacturing of Metallic Components â€“ Process, \nStructure and Properties,â€ Prog. Mater. Sci., 92, pp. 112â€“\n224. \n[4] Liu, F., Lyu, F., Liu, F., Lin, X., and Huang, C., 2020, \nâ€œLaves Phase Control of Inconel 718 Superalloy \nFabricated by Laser Direct Energy Deposition via Î´ \nAging and Solution Treatment,â€ J. Mater. Res. Technol., \n9(5), pp. 9753â€“9765. \n[5] He, X., DebRoy, T., and Fuerschbach, P. W., 2003, \nâ€œAlloying Element Vaporization during Laser Spot \nWelding of Stainless Steel,â€ J. Phys. Appl. Phys., 36(23), \np. 3079. \n[6] Luo, M., Li, R., Zheng, D., Kang, J., Wu, H., Deng, S., and \nNiu, P., 2023, â€œFormation Mechanism of Inherent \nSpatial Heterogeneity of Microstructure and Mechanical \nProperties of NiTi SMA Prepared by Laser Directed \nEnergy Deposition,â€ Int. J. Extreme Manuf., 5(3), p. \n035005. \n[7] Webster, S., Lin, H., Carter III, F. M., Ehmann, K., and \nCao, J., 2021, â€œPhysical Mechanisms in Hybrid Additive \nManufacturing: A Process Design Framework,â€ J. \nMater. Process. Technol., 291, p. 117048. \n[8] KÃ¶rner, C., Markl, M., and Koepf, J. A., 2020, â€œModeling \nand Simulation of Microstructure Evolution for Additive \nManufacturing of Metals: A Critical Review,â€ Metall. \nMater. Trans. A, 51(10), pp. 4970â€“4983. \n[9] Smoqi, Z., Bevans, B. D., Gaikwad, A., Craig, J., Abul-\nHaj, A., Roeder, B., Macy, B., Shield, J. E., and Rao, P., \n2022, â€œClosed-Loop Control of Meltpool Temperature in \nDirected Energy Deposition,â€ Mater. Des., 215, p. \n110508. \n[10] Liao, S., Webster, S., Huang, D., Council, R., Ehmann, K., \nand Cao, J., 2022, â€œSimulation-Guided Variable Laser \nPower Design for Melt Pool Depth Control in Directed \nEnergy Deposition,â€ Addit. Manuf., 56, p. 102912. \n[11] Liao, S., Jeong, J., Zha, R., Xue, T., and Cao, J., 2023, \nâ€œSimulation-Guided Feedforward-Feedback Control of \nMelt Pool Temperature in Directed Energy Deposition,â€ \nCIRP Ann. \n[12] van Beek, A., Karkaria, V., and Chen, W., 2022, â€œDigital \nTwins for the Designs of Systems: A Perspective.â€ \n[13] Wang, J., Ye, L., Gao, R. X., Li, C., and Zhang, L., 2019, \nâ€œDigital Twin for Rotating Machinery Fault Diagnosis in \nSmart Manufacturing,â€ Int. J. Prod. Res., 57(12), pp. \n3920â€“3934. \n[14] Raissi, M., Perdikaris, P., and Karniadakis, G. E., 2019, \nâ€œPhysics-Informed Neural Networks: A Deep Learning \nFramework for Solving Forward and Inverse Problems \nInvolving Nonlinear Partial Differential Equations,â€ J. \nComput. Phys., 378, pp. 686â€“707. \n[15] Liao, S., Xue, T., Jeong, J., Webster, S., Ehmann, K., and \nCao, J., 2023, â€œHybrid Thermal Modeling of Additive \nManufacturing \nProcesses \nUsing \nPhysics-Informed \nNeural Networks for Temperature Prediction and \nParameter Identification,â€ Comput. Mech., 72(3), pp. \n499â€“512. \n[16] Mozaffar, M., Paul, A., Al-Bahrani, R., Wolff, S., \nChoudhary, A., Agrawal, A., Ehmann, K., and Cao, J., \n2018, â€œData-Driven Prediction of the High-Dimensional \nThermal History in Directed Energy Deposition \nProcesses via Recurrent Neural Networks,â€ Manuf. Lett., \n18, pp. 35â€“39. \n[17] Mozaffar, M., Liao, S., Lin, H., Ehmann, K., and Cao, J., \n2021, \nâ€œGeometry-Agnostic \nData-Driven \nThermal \nModeling of Additive Manufacturing Processes Using \nGraph Neural Networks,â€ Addit. Manuf., 48, p. 102449. \n[18] Yavari, R., Smoqi, Z., Riensche, A., Bevans, B., Kobir, H., \nMendoza, H., Song, H., Cole, K., and Rao, P., 2021, \nâ€œPart-Scale Thermal Simulation of Laser Powder Bed \nFusion Using Graph Theory: Effect of Thermal History \non Porosity, Microstructure Evolution, and Recoater \nCrash,â€ Mater. Des., 204, p. 109685. \n[19] Greenhill, S., Rana, S., Gupta, S., Vellanki, P., and \nVenkatesh, S., 2020, â€œBayesian Optimization for \nAdaptive Experimental Design: A Review,â€ IEEE \nAccess, 8, pp. 13937â€“13948. \n[20] Mozaffar, M., Liao, S., Jeong, J., Xue, T., and Cao, J., \n2023, â€œDifferentiable Simulation for Material Thermal \nResponse Design in Additive Manufacturing Processes,â€ \nAddit. Manuf., 61, p. 103337. \n[21] Shahin, M., Chen, F. F., Bouzary, H., and Krishnaiyer, K., \n2020, â€œIntegration of Lean Practices and Industry 4.0 \nTechnologies: Smart Manufacturing for next-Generation \n12 \nAuthor name / Manufacturing Letters 00 (2023) 000â€“000 \nEnterprises,â€ Int. J. Adv. Manuf. Technol., 107(5), pp. \n2927â€“2936. \n[22] Krenczyk, D., 2022, â€œDynamic Simulation Models as \nDigital Twins of Logistics Systems Driven by Data from \nMultiple Sources,â€ J. Phys. Conf. Ser., 2198(1), p. \n012059. \n[23] BÃ¡rkÃ¡nyi, Ã., ChovÃ¡n, T., NÃ©meth, S., and Abonyi, J., \n2021, â€œModelling for Digital Twinsâ€”Potential Role of \nSurrogate Models,â€ Processes, 9(3), p. 476. \n[24] Hochreiter, S., and Schmidhuber, J., 1997, â€œLong Short-\nTerm Memory,â€ Neural Comput., 9(8), pp. 1735â€“1780. \n[25] Yang, S., Yu, X., and Zhou, Y., 2020, â€œLSTM and GRU \nNeural Network Performance Comparison Study: \nTaking Yelp Review Dataset as an Example,â€ 2020 \nInternational Workshop on Electronic Communication \nand Artificial Intelligence (IWECAI), pp. 98â€“101. \n[26] Irie, K., TÃ¼ske, Z., Alkhouli, T., SchlÃ¼ter, R., and Ney, H., \n2016, â€œLSTM, GRU, Highway and a Bit of Attention: \nAn Empirical Overview for Language Modeling in \nSpeech Recognition,â€ Interspeech 2016, ISCA, pp. \n3519â€“3523. \n[27] Van Houdt, G., Mosquera, C., and NÃ¡poles, G., 2020, â€œA \nReview on the Long Short-Term Memory Model,â€ Artif. \nIntell. Rev., 53(8), pp. 5929â€“5955. \n[28] Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, \nL., Gomez, A. N., Kaiser, Å., and Polosukhin, I., 2017, \nâ€œAttention Is All You Need,â€ Advances in Neural \nInformation Processing Systems, Curran Associates, Inc. \n[29] Ding, S., Zhu, L., and Xu, X., 2022, â€œA Novel LSTM-\n1DCNN-Based Deep Network for Fault Diagnosis in \nChemical Process,â€ 2022 China Automation Congress \n(CAC), pp. 3744â€“3749. \n[30] Shih, S.-Y., Sun, F.-K., and Lee, H., 2019, â€œTemporal \nPattern Attention for Multivariate Time Series \nForecasting,â€ Mach. Learn., 108(8), pp. 1421â€“1441. \n[31] Vidyaratne, L. S., Alam, M., Glandon, A. M., Shabalina, \nA., Tennant, C., and Iftekharuddin, K. M., 2022, â€œDeep \nCellular Recurrent Network for Efficient Analysis of \nTime-Series Data With Spatial Information,â€ IEEE \nTrans. Neural Netw. Learn. Syst., 33(11), pp. 6215â€“\n6225. \n[32] Billa, J., 2018, â€œDropout Approaches for LSTM Based \nSpeech Recognition Systems,â€ 2018 IEEE International \nConference on Acoustics, Speech and Signal Processing \n(ICASSP), pp. 5879â€“5883. \n[33] Amin Maleki Sadr, M., Zhu, Y., and Hu, P., 2023, â€œAn \nAnomaly Detection Method for Satellites Using Monte \nCarlo Dropout,â€ IEEE Trans. Aerosp. Electron. Syst., \n59(2), pp. 2044â€“2052. \n[34] MilanÃ©s-Hermosilla, D., Trujillo CodorniÃº, R., LÃ³pez-\nBaracaldo, R., SagarÃ³-Zamora, R., Delisle-Rodriguez, \nD., Villarejo-Mayor, J. J., and NÃºÃ±ez-Ãlvarez, J. R., \n2021, â€œMonte Carlo Dropout for Uncertainty Estimation \nand Motor Imagery Classification,â€ Sensors, 21(21), p. \n7241. \n[35] Stein, M., 1987, â€œLarge Sample Properties of Simulations \nUsing Latin Hypercube Sampling,â€ Technometrics, \n29(2), pp. 143â€“151. \n[36] Matsuda, T., and Komaki, F., 2017, â€œTime Series \nDecomposition into Oscillation Components and Phase \nEstimation,â€ Neural Comput., 29(2), pp. 332â€“367. \n[37] Langhammer, L., Sotner, R., and Theumer, R., 2023, \nâ€œVarious-Order Low-Pass Filter with the Electronic \nChange of Its Approximation,â€ Sensors, 23(19), p. 8057. \n[38] Selvin, S., Vinayakumar, R., Gopalakrishnan, E. A., \nMenon, V. K., and Soman, K. P., 2017, â€œStock Price \nPrediction Using LSTM, RNN and CNN-Sliding \nWindow Model,â€ 2017 International Conference on \nAdvances \nin \nComputing, \nCommunications \nand \nInformatics (ICACCI), pp. 1643â€“1647. \n[39] Mikolov, T., and Zweig, G., 2012, â€œContext Dependent \nRecurrent Neural Network Language Model,â€ 2012 \nIEEE Spoken Language Technology Workshop (SLT), \npp. 234â€“239. \n[40] Kingma, D. P., and Welling, M., 2022, â€œAuto-Encoding \nVariational Bayes.â€ \n[41] Tao, S., van Beek, A., Apley, D. W., and Chen, W., 2020, \nâ€œBayesian Optimization for Simulation-Based Design of \nMulti-Model \nSystems,â€ \nAmerican \nSociety \nof \nMechanical Engineers Digital Collection. \n[42] Shi, G., Lin, Y., Chung, S.-J., Yue, Y., and Wierman, A., \n2020, â€œOnline Optimization with Memory and \nCompetitive Control,â€ Advances in Neural Information \nProcessing Systems, Curran Associates, Inc., pp. 20636â€“\n20647. \n[43] Thelen, A., Zhang, X., Fink, O., Lu, Y., Ghosh, S., Youn, \nB. D., Todd, M. D., Mahadevan, S., Hu, C., and Hu, Z., \n2022, â€œA Comprehensive Review of Digital Twinâ€”Part \n2: Roles of Uncertainty Quantification and Optimization, \na Battery Digital Twin, and Perspectives,â€ Struct. \nMultidiscip. Optim., 66(1), p. 1. \n[44] Han, G., Jeong, J., and Kim, J.-H., 2023, â€œAdaptive \nBayesian Optimization for Fast Exploration Under \nSafety Constraints,â€ IEEE Access, 11, pp. 42949â€“42969. \n[45] Chen, S., Peng, Z., Yang, Y., Dong, X., and Zhang, W., \n2017, â€œIntrinsic Chirp Component Decomposition by \nUsing Fourier Series Representation,â€ Signal Process., \n137, pp. 319â€“327. \n[46] Taylor, S. J., and Letham, B., 2017, Forecasting at Scale, \nPeerJ Preprints. \n[47] Schulz, E., Speekenbrink, M., and Krause, A., 2018, â€œA \nTutorial on Gaussian Process Regression: Modelling, \nExploring, and Exploiting Functions,â€ J. Math. Psychol., \n85, pp. 1â€“16. \n[48] Oradei-Basile, A., and Radavich, J. F., 1991, â€œA Current \nT-T-T Diagram for Wrought Alloy 718,â€ Superalloys \n718, 625 and Various Derivatives (1991), TMS, pp. 325â€“\n335. \n[49] Xie, X., Bennett, J., Saha, S., Lu, Y., Cao, J., Liu, W. K., \nand Gan, Z., 2021, â€œMechanistic Data-Driven Prediction \nof as-Built Mechanical Properties in Metal Additive \nManufacturing,â€ Npj Comput. Mater., 7(1), pp. 1â€“12. \n[50] Tajyar, A., Brooks, N., Holtham, N., Rowe, R., Newell, D. \nJ., Palazotto, A. N., and Davami, K., 2022, â€œEffects of a \nModified Heat-Treatment on Microstructure and \nMechanical Properties of Additively Manufactured \nInconel 718,â€ Mater. Sci. Eng. A, 838, p. 142770. \n \n"
}